CREATE TRIGGER addAttributeCommit
  AFTER INSERT ON Attributes
  FOR EACH ROW
  BEGIN
    UPDATE Users
    SET last_commit=CURRENT_TIMESTAMP
    WHERE netID=NEW.netID;
  end;

CREATE TRIGGER editAttributeCommit
  AFTER UPDATE ON Attributes
  FOR EACH ROW
  BEGIN
    UPDATE Users
    SET last_commit=CURRENT_TIMESTAMP
    WHERE netID=NEW.netID;
  end;

CREATE TRIGGER deleteAttributeCommit
  AFTER DELETE ON Attributes
  FOR EACH ROW
  BEGIN
    UPDATE Users
    SET last_commit=CURRENT_TIMESTAMP
    WHERE netID=OLD.netID;
  end;

CREATE TRIGGER addClassCommit
  AFTER INSERT ON Classes
  FOR EACH ROW
  BEGIN
    UPDATE Users
    SET last_commit=CURRENT_TIMESTAMP
    WHERE netID=NEW.netID;
  end;

CREATE TRIGGER editClassCommit
  AFTER UPDATE ON Classes
  FOR EACH ROW
  BEGIN
    IF OLD.weighted=0 AND NEW.weighted=1 THEN
      UPDATE Weights
      SET Weights.subject=NEW.subject, Weights.courseNum=NEW.courseNum, Weights.courseName=NEW.courseName, Weights.weight=0
      WHERE Weights.netID=OLD.netID AND Weights.subject=OLD.subject AND Weights.courseNum=OLD.courseNum AND Weights.courseName=OLD.courseName;
      UPDATE Attributes
      SET Attributes.subject=NEW.subject, Attributes.courseNum=NEW.courseNum, Attributes.courseName=NEW.courseName
      WHERE Attributes.netID=OLD.netID AND Attributes.subject=OLD.subject AND Attributes.courseNum=OLD.courseNum AND Attributes.courseName=OLD.courseName;
    ELSE
      UPDATE Weights
      SET Weights.subject=NEW.subject, Weights.courseNum=NEW.courseNum, Weights.courseName=NEW.courseName, Weights.weight=-1
      WHERE Weights.netID=OLD.netID AND Weights.subject=OLD.subject AND Weights.courseNum=OLD.courseNum AND Weights.courseName=OLD.courseName;
      UPDATE Attributes
      SET Attributes.subject=NEW.subject, Attributes.courseNum=NEW.courseNum, Attributes.courseName=NEW.courseName
      WHERE Attributes.netID=OLD.netID AND Attributes.subject=OLD.subject AND Attributes.courseNum=OLD.courseNum AND Attributes.courseName=OLD.courseName;
    END IF;
  end;

CREATE TRIGGER deleteClassCommit
  AFTER DELETE ON Classes
  FOR EACH ROW
  BEGIN
    DELETE FROM Attributes
    WHERE OLD.netID=Attributes.netID AND OLD.subject=Attributes.subject AND OLD.courseNum=Attributes.courseNum AND OLD.courseName=Attributes.courseName;
    DELETE FROM Weights
    WHERE OLD.netID=Weights.netID AND OLD.subject=Weights.subject AND OLD.courseNum=Weights.courseNum AND OLD.courseName=Weights.courseName;
  end;

CREATE TRIGGER editUser
  AFTER UPDATE ON Users
  FOR EACH ROW
  BEGIN
    IF OLD.netID != NEW.netID THEN
      UPDATE Classes
      SET Classes.netID=NEW.netID
      WHERE Classes.netID=OLD.netID;
    end if;
  end;

CREATE TRIGGER addWeightCommit
  AFTER INSERT ON Weights
  FOR EACH ROW 
  BEGIN
    UPDATE Users
    SET last_commit=CURRENT_TIMESTAMP
    WHERE netID=NEW.netID;
  end;

CREATE TRIGGER editWeightCommit
  AFTER UPDATE ON Weights
  FOR EACH ROW
  BEGIN
    UPDATE Users
    SET last_commit=CURRENT_TIMESTAMP
    WHERE netID=NEW.netID;
  end;

CREATE TRIGGER deleteWeightCommit
  AFTER DELETE ON Weights
  FOR EACH ROW
  BEGIN
    DELETE FROM Attributes
    WHERE Attributes.netID=OLD.netID AND Attributes.subject=OLD.subject AND Attributes.courseNum=OLD.courseNum AND Attributes.courseName=OLD.courseName AND Attributes.category=OLD.category;
  end;